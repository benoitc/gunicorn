%{__python} setup.py install --skip-build --root=$RPM_BUILD_ROOT

# Build the HTML documentation using the default theme and install
# it in the build root.
# The environment variable READTHEDOCS is set to True as a workaround
# in order to be able to build the documentation using the default
# theme. There seems to be a small bug in docs/source/conf.py, but this
# file is not modified at this time, so as to avoid inducing other bugs.
cd docs
%{__make} READTHEDOCS="True" html
cd ..

%if ! (0%{?fedora} > 12 || 0%{?rhel} > 5)
%{!?python_sitelib: %global python_sitelib %(%{__python} -c "from distutils.sysconfig import get_python_lib; print(get_python_lib())")}
%{!?python_sitearch: %global python_sitearch %(%{__python} -c "from distutils.sysconfig import get_python_lib; print(get_python_lib(1))")}
%endif

INSTALLED_FILES="\
%{python_sitelib}/*
%{_bindir}/*
%doc LICENSE NOTICE README.rst THANKS docs/build/html
"
echo "$INSTALLED_FILES" > INSTALLED_FILES
